<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>JDFTx: Solvation of molecules</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="jdftx-55.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">JDFTx
   &#160;<span id="projectnumber">1.4.2</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('SolvationMolecule.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Solvation of molecules </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><div class="image">
<img src="WaterBoundCharge.jpg" alt="WaterBoundCharge.jpg"/>
</div>
<p>All the calculations so far have been of isolated molecules in vacuum, which is a good description for dilute gases. However, chemical reactions often occur in a solution, and predicting reaction mechanisms using DFT requires calculating structures and free energies of molecules in solution. Directly describing the solvent using its constituent molecules requires several thousands of DFT calculations to sample all configurations of solvent molecules, and is extremely computationally intensive. A practical alternative is to use a continuum solvation model which directly approximates the equilibrium effect of the solvent on a solute, without treating individual solvent configurations.</p>
<p>A major focus in the development of JDFTx has been the development of a heirarchy of solvation models from continuum to a detailed classical DFT approach, within the framework of Joint Density Functional Theory. (That's where JDFTx gets its J!) This tutorial shows how to put molecules in solution and introduces some of the commands that control solvation and fluid properties.</p>
<p>Let's put a water molecule in liquid water. The free energy of this process is related to the vapor pressure of liquid water and can be calculated from experimental measurements as -0.0101 Hartrees (= -6.33 kcal/mol). First, we perform the calculation in vacuum using the input files </p>
<pre class="fragment">#Save to common.in
lattice Cubic 15
coulomb-interaction Isolated
coulomb-truncation-embed 0 0 0
ion-species GBRV/$ID_pbe.uspp
elec-cutoff 20 100
coords-type cartesian     
</pre><p>containing the shared commands as before, and </p>
<pre class="fragment">#Save to Vacuum.in and run as jdftx -i Vacuum.in | tee Vacuum.out:
include common.in
ion O   0.00 0.00  0.00  0
ion H   0.00 1.13 +1.45  1
ion H   0.00 1.13 -1.45  1
ionic-minimize nIterations 10
dump-name Vacuum.$VAR
dump End State
</pre><p>Upon completion, this calculation will output the optimized geometry and wavefunctions of a water molecule in vacuum. Next, we run a solvated calculation starting from this state: </p>
<pre class="fragment">#Save to LinearPCM.in and run as jdftx -i LinearPCM.in | tee LinearPCM.out:
include common.in
include Vacuum.ionpos
initial-state Vacuum.$VAR
ionic-minimize nIterations 10
dump-name LinearPCM.$VAR
dump End State BoundCharge

fluid LinearPCM     #Simple continuum fluid with linear response
pcm-variant GLSSA13 #default, if not specified
fluid-solvent H2O   #Solvent is water
</pre><p>This runs a solvated calculation with the simplest GLSSA13 LinearPCM model (this is exactly the same model which was later implemented in VASP as VASPsol) and outputs the bound charge density induced in the solvent by electrostatic interactions with the solute. Examine the output file: now there are lines starting with 'Linear fluid' between electronic steps. These correspond to optimization of the fluid degrees of freedom (in this simple case, by solving a linearized Poisson-Boltzmann equation) in response to the solute's charge density. The energy components now include an additional piece Adiel, which is the total contribution due to the solvent.</p>
<p>The solvation free energy is the difference between the final energies in Vacuum.out and LinearPCM.out, which turns out to be (-17.2682) - (-17.2795) = -0.0113 Hartrees in good agreement with the experimental estimate of -0.0101 Hartrees. Visualizing the bound charge density (nbound) using </p>
<pre class="fragment">createXSF LinearPCM.out LinearPCM.xsf nbound
</pre><p>results in the first panel of the figure above.</p>
<p>The command <a class="el" href="CommandFluid.html">fluid</a> selects the broad class of solvation model, some of which support many variants selected by command <a class="el" href="CommandPcmVariant.html">pcm-variant</a>. Some of the common / recommended models are:</p>
<ul>
<li><b>LinearPCM (GLSSA13)</b>: This default LinearPCM is currently the most popular solvation model in solid-state calculations, especially in the form of the VASPsol solvation module in the proprietary DFT software VASP. In this simple solvation model, the liquid responds with induced charge densities at the surface of a dielectric cavity surrounding the solute molecule, and this cavity in turn is determined as a function of the solute electron density. This solvation model is selected by the following commands, as described above: <pre class="fragment">fluid LinearPCM
pcm-variant GLSSA13
</pre></li>
<li><b>SCCS</b>: The self-consistent continuum solvation (SCCS) method is closely related to the default LinearPCM and primarily differs in the details of the function that determines the cavity from the electron density. This is the solvation model available in the Quantum Espresso DFT software. There are several parametrizations of this model, all with names starting with SCCS (see command <a class="el" href="CommandPcmVariant.html">pcm-variant</a>): <pre class="fragment">fluid LinearPCM
pcm-variant SCCS_*
</pre></li>
<li><b>CANDLE</b> This is the latest solvation model and recommended for most applications. It has the computational expense of the simpler LinearPCM's above but incorporates the accuracy and robustness of the more expensive models discussed next. In summary it uses SaLSA's nonlocal electron-density overlap method to determine the cavity, but then uses a local dielectric response like other LinearPCM's. It additionally corrects for the asymmetry in the response of the liquid to positively and negatively charged solutes. <pre class="fragment">fluid LinearPCM
pcm-variant CANDLE
</pre></li>
<li><b>NonlinearPCM</b>: This class of solvation models captures the nonlinearity in the dielectric and ionic response of the solvent. This is necessary if you need to capture details in the capacitance of electrochemical systems, for example. <pre class="fragment">fluid NonlinearPCM
pcm-variant GLSSA13
</pre></li>
<li><b>SaLSA</b>: This solvation model directly captures the nonlocal response of the liquid using an angular mometum expansion (not continuum like the rest), and determines the cavity from an overlap of solute and solvent electron densities. This model is typically a factor of 10 more expensive than the continuum solvation models. Usually CANDLE, which empirically mimics the SaLSA response, should suffice, but SaLSA is a parameter-free physically-motivated model that is a useful benchmark for the more empirical methods like CANDLE in new / untested classes of solutes. <pre class="fragment">fluid SaLSA
</pre></li>
<li><b>ClassicalDFT</b>: A full classical DFT description of the fluid is used to fully capture the microscopic structuring of the liquid at the atomic scale. This method is typically a factor of 100 more expensive than the continuum methods, but is the only method that provides access to <em>liquid structure</em> in the solvent in addition to the electronic structure of the solute. This is particularly useful for analyzing in-situ structure measurements (eg. X-ray) of electrochemical interfaces. See commands <a class="el" href="CommandFluidSolvent.html">fluid-solvent</a> for controlling details of the solvent ClassicalDFT such as orinetation sampling and <a class="el" href="CommandFluidGummelLoop.html">fluid-gummel-loop</a> to control the self-consistency algorithm that optimizes the liquid and electronic states. With default options, all it takes to use it is the command: <pre class="fragment"> fluid ClassicalDFT
</pre></li>
</ul>
<p>Also see the various commands listed under fluid in the <a class="el" href="Commands.html">Input file documentation</a> page for controlling numerous details of the fluid calculation.</p>
<p>Now, as an exercise run the water calculation with each class of solvation model, compare the solvation energies and visualize the bound charge in the liquid using createXSF and VESTA, as shown below and at the start of this tutorial. (SaLSA and ClassicalDFT will take a while!) Note how LinearPCM, the nonlocally-inspired variant CANDLE, as well as the non-local model SaLSA have the bound charge mostly restricted to a surface surrounding the solute, whereas ClassicalDFT, exhibits a shell structure with several layers surrounding the solute. Additionally, in this simple case of a neutral solute, all the solvation models are comparably accurate.</p>
<div class="image">
<img src="WaterBoundCharge.jpg" alt="WaterBoundCharge.jpg"/>
</div>
 </div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
</div>
</body>
</html>
